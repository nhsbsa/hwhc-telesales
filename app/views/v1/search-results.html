{% extends 'layout-fullscreen.html' %}

{% set filteredRows = '' | getPatientData | getTableRows %}
{% set pageName = '' | getSearchTitle %}

{% block beforeContent %}
 {{ backLink({
    href: 'search',
    text: 'Back'
  }) }}
{% endblock %}

{% block content %}

  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-full">

      <div class="nhsuk-card">
            <div class="nhsuk-card__content">

        <h1 class="nhsuk-heading-m">{{ pageName }}</h1>

        {% if data.searchCertificateType in ['hrtppc', ''] %}

        <div class="nhsuk-grid-row">
          <div class="nhsuk-grid-column-one-half">
            {{ insetText({
              classes: 'nhsuk-inset-text--summary',
              html: '<p class="nhsuk-body-s">'+data.summaryText+'&nbsp;&nbsp;<a class="nhsuk-link" href="search">Change search</a></p>'
            }) }}
          </div>

          <div class="nhsuk-grid-column-one-half">
            {{ button({
              text: "Start HRT PPC application",
              classes: 'nhsuk-u-float-right nhsuk-button nhsuk-u-margin-0',
              href: "hrtppc/new-application"
            }) }}
          </div>
        </div>

        {% else %}

        {{ insetText({
          classes: 'nhsuk-inset-text--summary',
          html: '<p class="nhsuk-body-s">'+data.summaryText+'&nbsp;&nbsp;<a class="nhsuk-link" href="search">Change search</a></p>'
        }) }}

        {% endif %}


          {% if ( filteredRows.length > 0 ) %}

              {{ table({
                panel: false,
                caption: 'Exemptions',
                captionClasses: 'nhsuk-u-visually-hidden',
                firstCellIsHeader: false,
                responsive: true,
                tableClasses: 'patient-table',
                head: '' | getTableHeadRows,
                rows: filteredRows
              }) }}

              <div class="nhsuk-grid-row">
    
                <div class="nhsuk-grid-column-one-half">
                    {{ pagination( 'nhsuk-u-margin-0' | getPaginationLinks ) }}
                </div>

                <div class="nhsuk-grid-column-one-half">
                    {{ button({
                        text: 'Reset',
                        href: 'search',
                        classes: 'nhsuk-u-float-right nhsuk-button--secondary nhsuk-u-margin-0'
                    }) }}
                </div>

              </div>

          {% endif %}

            </div>
        </div>

    </div>
</div>

{% endblock %}